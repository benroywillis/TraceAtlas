{
    "Kernels":
    {
        "Inner":
        {
            "ScopedVariables":[
                "i32 %Iterator = i32 0",
                "i32 %A = i32 1",
                "i32 %B = i32 -1",
                "i32 %C = i32 -1",
                "i32 %D = i32 1"
            ],
            "Inputs":[
                "i32 %BaseRead",
                "i32 %BaseWrite"
            ],
            "Body":
            [
                "%a = MemoryRead(i32 0)",
                "%b = MemoryRead(i32 1)",
                "%c = MemoryRead(i32 2)",
                "%d = MemoryRead(i32 3)",
                "%w = mult %a, %A",
                "%x = mult %b, %B",
                "%y = mult %c, %C",
                "%z = mult %d, %D",
                "%g = add %w, %x",
                "%h = add %y, %z",
                "%i = add %g, %h",
                "MemoryWrite(%i)",
                "ret void"
            ],
            "Loop":
            {
                "Body":[
                    "%next = add %Iterator 1",
                    "%done = icmp eq %iterator, i32 511",
                    "%result = select %done, i1 1, i1 0",
                    "%Iterator = %next",
                    "ret %result"
                ]
            },
            "MemoryRead":
            {
                "Inputs":
                [
                    "i32 Index"
                ],
                "Output":
                [
                    "i32"
                ],
                "Body":
                [
                    "%tmp0 = add %BaseRead, %Iterator",
                    "%tmp1 = add %tmp0, i32 1",
                    "%tmp2 = add %tmp0, i32 512",
                    "%tmp3 = add %tmp2, i32 1",
                    "%cmp0 = icmp eq %Index, i32 0",
                    "%cmp1 = icmp eq %Index, i32 1",
                    "%cmp2 = icmp eq %Index, i32 2",
                    "%res0 = select %cmp0, %tmp0, %tmp1",
                    "%res1 = select %cmp1, %res0, %tmp2",
                    "%res2 = select %cmp2, %res1, %tmp3",
                    "%addr = mult %res2, i32 4",
                    "%result = load %addr",
                    "ret %result"
                ]
            },
            "MemoryWrite":
            {
                "Inputs":
                [
                    "i32 Data"
                ],
                "Body":
                [
                    "store %BaseWrite, %Data",
                    "ret void"
                ]
            }
        },
        "2DConv":
        {
            "ScopedVariables":[
                "i32 %Iterator = i32 0"
            ],
            "Inputs":[
                "i32 %BaseRead",
                "i32 %BaseWrite"
            ],
            "Body":
            [
                "%offset = mult i32 512, %Iterator",
                "%adjOffset = mult i32 4, %offset",
                "%inputAddress = add %adjOffset, %BaseRead",
                "%yoffset = mult i32 511, %Iterator",
                "%yadjOffset = mult i32 4, %yoffset",
                "%outputAddress = add %yadjOffset, %BaseWrite",
                "Inner(%inputAddress, %outputAddress)",
                "ret void"
            ],
            "Loop":
            {
                "Body":[
                    "%next = add %Iterator 1",
                    "%done = icmp eq i32 %iterator 511",
                    "%result = select %done, i1 1, i1 0",
                    "%Iterator = %next",
                    "ret %result"
                ]
            }
        }
    }
}